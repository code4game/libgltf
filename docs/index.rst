.. libgltf documentation master file, created by
   sphinx-quickstart on Mon Oct 12 18:56:34 2020.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

Welcome to libgltf's documentation!
===================================

|glTF 2.0| |docs| |bestpractices| |visit-milstones|

|github-action| |coveralls| |codacy|

This project was generated by glTF 2.0 JSON schema and support to load the glTF 2.0 file to a struct `SGlTF`.

It was used in glTFForUE4_.

Features
==========

* `glTF 2.0`_
* Load the gltf/embedded/glb file
* This is a static library
* Cross platform
* C++11
* Supports the Unicode and UTF8
* Supports some extensions
   * `KHR_draco_mesh_compression` - `Google's Draco`_
   * `KHR_lights_punctual`
   * `KHR_materials_pbrSpecularGlossiness`
   * `KHR_materials_clearcoat`
   * and more
* Platforms
   * Windows
      * Win32 (win32)
      * x64 (win64)
   * Linux (linux)
   * macOS (macos)
   * Android
      * armeabi-v7a
      * armeabi-v7a-with-neon
      * arm64-v8a
      * x86
      * x86_64
   * iOS
      * iOS (iphoneos)
      * watchOS (watchos)
      * simulator

Getting Started
===============

1. Update the submodule

   ..

      Run :code:`git submodule update --init`

2. Generate the project by [CMake]

   ..

      Run :code:`cmake -G "[GENERATOR BY YOUR SYSTEM]" [LIBGLTF FOLDER]`

3. Build the project and generate the the static library `libgltf.lib` or `libgltf.a`
4. Include `libgltf/libgltf.h` in your project.
5. Link the static library `libgltf.lib` or `libgltf.a` in your project.

   ..
   
      You have to link the static library `draco.lib` or `draco.a` with your project, if you want support the `Google's Draco`_.
      And you can find the draco in the external folder.

Code example:

.. code-block:: cpp

   std::shared_ptr<libgltf::IglTFLoader> gltf_loader = libgltf::IglTFLoader::Create(/*your gltf file*/);
   gltf_loader->Execute();
   std::shared_ptr<libgltf::SGlTF> loaded_gltf = gltf_loader->glTF().lock();
   if (!loaded_gltf)
   {
       printf("failed to load your gltf file");
   }


Usage
==========

Generate the `makefile` or `ninja` or `visual c++ project` or `xcode project` by [CMake].

For now, just build to a static library - `libgltf.(lib/a)`.

How to use
^^^^^^^^^^

Load the glTF file
------------------

You can load the glTF file by the function - `libgltf::IglTFLoader::Create`, like this:

.. code-block:: cpp

   std::shared_ptr<libgltf::IglTFLoader> gltf_loader = libgltf::IglTFLoader::Create("Monster.gltf");
   std::shared_ptr<libgltf::SGlTF> loaded_gltf = gltf_loader->glTF().lock();
   if (!loaded_gltf)
   {
       // the glTF file is valid
       return false;
   }

Load the mesh data
------------------

And get the mesh data, like this:

.. code-block:: cpp

   // get all indices of the triangle
   libgltf::TDimensionVector<1, size_t> triangle_data;
   std::shared_ptr<libgltf::TAccessorStream<libgltf::TDimensionVector<1, size_t> > > triangle_stream = std::make_shared<libgltf::TAccessorStream<libgltf::TDimensionVector<1, size_t> > >(triangle_data);
   gltf_loader->GetOrLoadMeshPrimitiveIndicesData(0, 0, triangle_stream);

   // get all points of the triangle
   libgltf::TDimensionVector<3, float> position_data;
   std::shared_ptr<libgltf::TAccessorStream<libgltf::TDimensionVector<3, float> > > position_stream = std::make_shared<libgltf::TAccessorStream<libgltf::TDimensionVector<3, float> > >(position_data);
   gltf_loader->GetOrLoadMeshPrimitiveAttributeData(0, 0, L"position", position_stream);

Load the image data
-------------------

You can get the image (data and type) by `libgltf::IglTFLoader::GetOrLoadImageData`, like this:

.. code-block:: cpp

   std::vector<uint8_t> image0_data;
   libgltf::string_t image0_data_type;
   gltf_loader->GetOrLoadImageData(0, image0_data, image0_data_type);

Advance
^^^^^^^^^^

Regenerate new code by the glTF schema
--------------------------------------

..

   You can update the c++11 source code by `jsonschematoc11`.

Generate the c++11 code:

1. Run `tools/batch/update_parser_by_scheme.bat` (Windows) or `tools/batch/update_parser_by_scheme.sh` (Unix/Linux/MacOS)
2. Build your version by CMake_, Ninja_ or VisualStudio_.

Character encoding
------------------

* default using UTF8, char and std::string
* set LIBGLTF_CHARACTOR_ENCODING in cmake command - UTF8, UTF16, UTF32 or UNICODE

Supports Google's draco
-----------------------

You can update the Google's draco submodule in external/draco or pull the draco repo by yourself.

Check the `LIBGLTF_USE_GOOGLE_DRACO` or set `LIBGLTF_USE_GOOGLE_DRACO` is `TRUE`.

* Set the `GOOGLE_DRACO_PATH_INCLUDE`, `GOOGLE_DRACO_PATH_BUILD`, `GOOGLE_DRACO_LIBRARY_DRACODEC_DEBUG`, `GOOGLE_DRACO_LIBRARY_DRACODEC_RELEASE`, `GOOGLE_DRACO_LIBRARY_DRACOENC_DEBUG` and `GOOGLE_DRACO_LIBRARY_DRACOENC_RELEASE`.
* Or enable the `LIBGLTF_USE_GOOGLE_DRACO_SUBMODULE` to compile with the submodule - `external/draco`.

Download the compiled library
-----------------------------

This project is compiled by github action, and you can download the compiled library with `Google's Draco`_ from `the action page`_ or `the release page`_.

Note:
   In `the action page`_ or `the release page`_, libraries was compiled with `MultiThreading` (/MT or /MTd) for **windows**.

Donation
==============================================================

..

   *Please consider donating to sustain my activities*

|support-buy-a-cup-of-coffee| |donation-beome-a-patreon|

License
==========

The MIT license.

.. _glTFForUE4: https://github.com/code4game/glTFForUE4

.. _`glTF 2.0`: https://www.khronos.org/gltf/

.. _`Google's Draco`: https://github.com/google/draco

.. _CMake: https://cmake.org/

.. _Ninja: https://ninja-build.org

.. _VisualStudio: https://visualstudio.microsoft.com

.. _`the action page`: https://github.com/code4game/libgltf/actions

.. _`the release page`: https://github.com/code4game/libgltf/releases

.. |glTF 2.0| image:: https://img.shields.io/badge/glTF-2%2E0-green.svg?style=flat
   :target: https://github.com/KhronosGroup/glTF

.. |docs| image:: https://readthedocs.org/projects/libgltf/badge/?version=latest
   :target: http://libgltf.rtfd.io/

.. |bestpractices| image:: https://bestpractices.coreinfrastructure.org/projects/1434/badge
   :target: https://bestpractices.coreinfrastructure.org/projects/1434

.. |visit-milstones| image:: https://img.shields.io/badge/visit-milestones-blue.svg?style=flat
   :target: https://github.com/code4game/libgltf/milestones

.. |github-action| image:: https://github.com/code4game/libgltf/workflows/build/badge.svg
   :target: https://github.com/code4game/libgltf/actions?query=workflow%3Abuild

.. |coveralls| image:: https://coveralls.io/repos/github/code4game/libgltf/badge.svg?branch=master
   :target: https://coveralls.io/github/code4game/libgltf?branch=master

.. |codacy| image:: https://api.codacy.com/project/badge/Grade/fa7ee9a5bc9b4befb703298ca721bc9a
   :target: https://www.codacy.com/app/code4game/libgltf?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=code4game/libgltf&amp;utm_campaign=Badge_Grade

.. |support-buy-a-cup-of-coffee| image:: https://img.shields.io/badge/support-buy%20a%20cup%20of%20coffee-orange.svg?style=flat
   :target: https://c4gio.itch.io/libgltf-ue4

.. |donation-beome-a-patreon| image:: https://img.shields.io/badge/donation-become%20a%20patreon-orange.svg?style=flat
   :target: https://www.patreon.com/bePatron?u=7553208
